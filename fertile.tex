% !TeX program = pdfLaTeX
\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{graphicx,psfrag,epsf}
\usepackage{enumerate}
\usepackage{natbib}
\usepackage{textcomp}
\usepackage[hyphens]{url} % not crucial - just used below for the URL
\usepackage{hyperref}
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

%\pdfminorversion=4
% NOTE: To produce blinded version, replace "0" with "1" below.
\newcommand{\blind}{0}

% DON'T change margins - should be 1 inch all around.
\addtolength{\oddsidemargin}{-.5in}%
\addtolength{\evensidemargin}{-.5in}%
\addtolength{\textwidth}{1in}%
\addtolength{\textheight}{1.3in}%
\addtolength{\topmargin}{-.8in}%

%% load any required packages here




\begin{document}


\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\if0\blind
{
  \title{\bf Creating optimal conditions for reproducible data analysis in R with
\texttt{fertile}}

  \author{
        Audrey Bertin \thanks{The authors gratefully acknowledge contributions from Hadley Wickham,
Jenny Bryan, Greg Wilson, Edgar Ruiz, and other members of the
\texttt{tidyverse} team.} \\
    Program in Statistical and Data Sciences, Smith College\\
     and \\     Benjamin S. Baumer \\
    Program in Statistical and Data Sciences, Smith College\\
      }
  \maketitle
} \fi

\if1\blind
{
  \bigskip
  \bigskip
  \bigskip
  \begin{center}
    {\LARGE\bf Creating optimal conditions for reproducible data analysis in R with
\texttt{fertile}}
  \end{center}
  \medskip
} \fi

\bigskip
\begin{abstract}
The advancement of scientific knowledge increasingly depends on ensuring
that data-driven research is reproducible: that two people with the same
data obtain the same results. However, while the necessity of
reproducibility is clear, there are significant behavioral and technical
challenges that impede its widespread implementation, and no clear
consensus on standards of what constitutes reproducibility in published
research. We focus on a series of common mistakes programmers make while
conducting data science projects in R, primarily through the RStudio
integrated development environment. \texttt{fertile} is an R package
that operates in two modes: proactively (to prevent reproducibility
mistakes from happening in the first place), and retroactively
(analyzing code that is already written for potential problems).
Furthermore, \texttt{fertile} is designed to educate the user about why
the mistakes are problematic, and how to fix them. We discuss
experimental results from testing \texttt{fertile} in an introductory
data science course.
\end{abstract}

\noindent%
{\it Keywords:} reproducibility, statistical software, workflow, collaboration
\vfill

\newpage
\spacingset{1.45} % DON'T change the spacing!

\section{Extended Abstract}\label{extended-abstract}

In the field of data science, an analyst has created \emph{reproducible}
work if: 1) their code and data files have been made publicly available,
and 2) these files produce identical results when run by another
analyst.

In the age of modern computer technology, where knowledge can be
instantly shared worldwide, reproducibility is becoming incredibly
important to the advancement of scientific knowledge.

The first reason for this is that reproducible research is transparent.
When researchers provide the code and data used for their work in a well
organized and reproducible format, readers are able to understand the
steps taken to generate findings from raw data and determine whether or
not they believe the results to be reliable or trustworthy. Without
reproducibility, research results must be blindly trusted.

The second reason is that reproducibility allows for collaboration and
extended research. The creators of reproducible research can easily
receive feedback and recommendations on their work, and others
interested in the research topic can see the code and easily apply the
methods and ideas used in one project to their own future work with
minimal effort.

However, while the necessity of reproducibility is clear, there are
significant behavioral and technical challenges that impede its
widespread implementation, and no clear consensus on standards of what
constitutes reproducibility in published research.

In defining the steps toward creating reproducible analyses, different
researchers place their emphasis on different areas, including file
structure, documentation, the use of file paths in code, and
accessibility. Within these categories, the recommendations for what
steps to take in ensuring reproducibility also vary.

Much of the discussion around reproducibility is also generalized,
written in a way applicable to users working with a variety of
statistical software programs. Since all statistical software programs
operate differently, generalized recommendations on reproducibility
often cannot go in depth. While they provide some useful guidelines,
they can often be relatively unhelpful, particularly to new analysts who
are unsure how to apply such recommendations within the software
programs they are using.

In order to be most effective, reproducibility recommendations must be
tailored to specific software programs. However, there has been very
little work on reproducibility that is tailored to this level of
specificity. In this paper, attempt to remedy that, focusing on
reproducibility in the R programming language with a concentration on
the RStudio integrated development environment.

R is an ideal candidate for reproducibility recommendations due to the
language's popularity for statistical analyses and the ease with which
analysts can download and begin using the software.

We propose an R package called \texttt{fertile}, which focuses on a
series of common reproducibility-harming mistakes programmers make while
conducting data science projects in R, warning users of their errors and
providing recommendations for how to correct them.

\texttt{fertile} operates in two modes: proactively (to prevent
reproducibility mistakes from happening in the first place), and
retroactively (analyzing code that is already written for potential
problems).

Retroactively, \texttt{fertile} is designed to be run on an R Project
folder, analyzing the project structure and the analyst's use of file
paths and considering randomness, among other areas of interest.
\texttt{fertile} creates reproducibility reports, identifying mistakes
that users have made and providing recommendations for remedies. For
example, fertile might identify an analyst's use of randomness in code
and recommend setting a seed.

Proactively, the package works similarly, identifying mistakes as they
are made by the user and outputting an educational warning message
identifying, and providing a solution for, the mistake. In its proactive
warning system, \texttt{fertile} focuses primarily on the use of file
paths. As users execute code, \texttt{fertile} looks for file paths
passed to functions, identifying when absolute paths are provided or
when paths point to a location outside of the project directory.

\texttt{fertile} is designed to educate the user about why the mistakes
are problematic, and how to fix them. It is written for a wide audience,
simple enough to be used by students in an introductory data science
course.

\section{Introduction}\label{introduction}

\section{The Importance of Ensuring
Reproducibility}\label{the-importance-of-ensuring-reproducibility}

One reason for this is that reproducible research encourages
transparency. Providing one's audience with well organized, reproducible
code and results allows readers to understand the steps taken to
generate findings from raw data and determine for themselves whether or
not they believe the results to be reliable or trustworthy.

Additionally, reproducibility encourages collaboration and extended
research, allows others to easily apply the methods used in one project
to their own work with minimal effort. \citet{bray2014five}

Fertile is designed to make reproducibility simple, providing fast and
easy methods to test an R project for reproducibility. The package is
intended to be usable by introductory data science students in their
first semester of R.

--\textgreater{} make sure this info is included somewhere:

From ``Five Concrete Reasons Your Students Should Be Learning to Analyze
Data in the Reproducible Paradigm'' (\citet{bray2014five})

\begin{itemize}
\tightlist
\item
  Helps with transparency: make clear data cleaning steps between raw
  data and final data
\item
  Helps with collaboration: easier to share code when it takes very few
  steps to run on a different computer
\end{itemize}

The other big ideas on the importance/use of this package (not from
sources):

\begin{itemize}
\tightlist
\item
  Make it easier for professors to grade students' code
\item
  Should be usable by intro level data science students
\item
  Possible use by reviewers of journal articles (and by those writing
  the articles)
\end{itemize}

\section{What Defines Reproducibility in Data
Science?}\label{what-defines-reproducibility-in-data-science}

\section{\texorpdfstring{Creating Comprehensive Reproducibility Reports
With
``fertile''}{Creating Comprehensive Reproducibility Reports With fertile}}\label{creating-comprehensive-reproducibility-reports-with-fertile}

Main points of different sources, as well as info about how they might
be used for the paper.

Here are some sources we might use for motivation behind the project:

\subsubsection{The Reproducibility
Crisis}\label{the-reproducibility-crisis}

Big idea: most scientific fields are facing a reproducibility crisis and
poor statistical use is considered one of the important reasons behind
this.

Not sure how useful this is due to the fact that it does not necessarily
focus on the same kind of reproducibility we are looking at, which is
code reproducibility rather than experimental reproducibility.

\citet{baker20161}

\subsubsection{Why is reproducibility
important?}\label{why-is-reproducibility-important}

From Popper in \texttt{The\ Logic\ of\ Scientific\ Discovery}:
``non-reproducible single occurrences are of no significance to
science.''

\citet{popper2005logic}

\subsubsection{What does reproducibility mean in data
science?}\label{what-does-reproducibility-mean-in-data-science}

``The ability of a researcher to duplicate the results of a prior study
using the same materials as were used by the original investigator. That
is, a second researcher might use the same raw data to build the same
analysis files and implement the same statistical analysis in an attempt
to yield the same results.''

\citet{goodman2016does}

From ``The Practice of Reproducibile Research'': Can all of the
figures/calculations related to the result be reproduced in a single
button press or at least with a reasonably small effort?

\citet{kitzes2017practice}

\subsubsection{What makes a data science project
reproducibile?}\label{what-makes-a-data-science-project-reproducibile}

Another way to think about this is: what features does fertile have that
match what different sources think needs to be checked to ensure
reproducibility?

Some big ideas from the OpenSci discussion page:

\begin{itemize}
\tightlist
\item
  code should use tidy style
\item
  project should have short vignette files -- most written code should
  be in an R/ directory
\item
  code and data should be stored in separate folders
\item
  a run environment and dependencies should be specified
\item
  there should be a README file
\item
  there should be a data dictionary
\item
  one master script
\item
  code should only use relative paths
\item
  code should be well commented and all variables should be defined
\end{itemize}

Big ideas from ``Packaging data analytical work reproducibly using R''

\begin{itemize}
\tightlist
\item
  research should be organized like an R package!
\item
  clear separation of data, method, and output
\item
  specify the computational environment that was used for the original
  analysis (typically in a plain text file)
\item
  there should be a README describing the project and where to get
  started
\item
  script files with reusable functions should go in an R/ directory
\item
  raw data files should be kept in a data/ directory
\item
  analysis scripts and report files should go in an analysis/ directory
\item
  for simpe projects, scripts should be given ascending names. For more
  complicated ones, the use of some sort of makefile is recommended
\item
  there should also be a DESCRIPTION file with information about the
  authors, project license, and software dependencies
\end{itemize}

\citet{marwick2018packaging}

From ``The Practice of Reproducible Research''

\begin{itemize}
\item
  Are the data openly accessible? If hosted online, is the web address
  reliable long-term?
\item
  Are they in a commonly used and well-documented file format? Avoid
  spreadsheets and instead use plain text data if possible!
\item
  Is the raw data available? Is sufficient metadata provided?
\item
  Are dependencies described properly?
\item
  Is full history of source code available through a public version
  history
\item
  Is there a README?
\item
  Are functions documented?
\item
  Is there narrative documentation explaining how the different pieces
  work together?
\item
  Are there usage examples?
\end{itemize}

Folder setup might look like:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Raw Data

  \begin{itemize}
  \tightlist
  \item
    Data
  \item
    README
  \end{itemize}
\item
  Clean Data

  \begin{itemize}
  \tightlist
  \item
    Data
  \end{itemize}
\item
  Results

  \begin{itemize}
  \tightlist
  \item
    Results file
  \end{itemize}
\item
  Src

  \begin{itemize}
  \tightlist
  \item
    Analysis script
  \item
    Script to clean data
  \end{itemize}
\end{enumerate}

\citet{kitzes2017practice}

From R OpenSci's Reproducibility Guide:

\url{http://ropensci.github.io/reproducibility-guide/}

\begin{itemize}
\tightlist
\item
  Is it clear where to begin?
\item
  Can you determinine which files were used as input to create output
  files?
\item
  Is there documentation about every result?
\item
  Are exact versions of external applications noted?
\item
  If using randomness, are seeds noted?
\item
  Have you specified a license or noted licenses if you used other
  people's content?
\item
  Are files easy to find?
\item
  Is it clear what the most recent file is?
\item
  Are there any folders that could be deleted?
\item
  Is analysis output done hierarchically?
\item
  Are there lots of manual data manipulation steps?
\end{itemize}

From ``A Guide to Reproducible Code in Ecology and Evolution'' (these
ideas are pretty universal, though):

A basic project structure:

\begin{itemize}
\item
  The data folder contains all input data (and metadata) used in the
  analysis.
\item
  The doc folder contains the manuscript
\item
  The figs directory contains figures generated by the analysis
\item
  The output folder contains any type of intermediate or output files
  (e.g.~simulation outputs, models, processed datasets, etc.). You might
  separate this and also have a cleaned-data folder.
\item
  The R directory contains R scripts with function definitions.
\item
  The reports folder contains RMarkdown files that document the analysis
  or report on results
\item
  Consistent, ordered naming of scripts
\item
  Use portable paths
\item
  Write unit tests (only for advanced coding)
\item
  Show the packages you used
\item
  Record dependencies and versions of outside things you use
\end{itemize}

\citet{cooper2017guide}

\section{Karl Broman's Suggestions}\label{karl-bromans-suggestions}

\begin{itemize}
\tightlist
\item
  Encapsulate everything within one directory
\item
  Separate raw data from derived data
\item
  Separate data from code
\item
  Use relative paths
\item
  Choose filenames correctly
\item
  Write README files
\end{itemize}

\url{http://kbroman.org/steps2rr/pages/organize.html}

\section{Why focus on R?}\label{why-focus-on-r}

\begin{itemize}
\tightlist
\item
  R is the most popular language for statistical programming and is
  specifically designed for statistics
\item
  R is great for reprodubility because the code is readable by users,
  and RMarkdown is a great way to show/explain processes
\item
  R is easy to install and begin using
\end{itemize}

--\textgreater{} from
\url{https://openresearchsoftware.metajnl.com/articles/10.5334/jors.bu/print/}

\section{Similar R Packages}\label{similar-r-packages}

\subsubsection{rrtools}\label{rrtools}

\url{https://github.com/benmarwick/rrtools}

\begin{itemize}
\tightlist
\item
  Creates a basic R package named after your research topic
\item
  Generates a license file
\item
  Connects to GitHub and creates a repository
\item
  Generates a README
\item
  Generates a reproducible directory structure
\item
  Creates a dockerfile
\item
  Creates a minimal travis file
\item
  Sets up testthat
\end{itemize}

\section{Msc sources to look at:}\label{msc-sources-to-look-at}

\subsubsection{\texorpdfstring{Victoria Stodden's ``Implementing
Reproducible Research''
book}{Victoria Stodden's Implementing Reproducible Research book}}\label{victoria-stoddens-implementing-reproducible-research-book}

\url{https://books.google.com/books?hl=en\&lr}=\&id=JcmSAwAAQBAJ\&oi=fnd\&pg=PP1\&dq=Victoria+stodden+reproducibility\&ots=ym\_gvSxMNH\&sig=B5N6FlkoocVjIprIZevtvrL33qQ\#v=onepage\&q=coombes\&f=false

\bibliographystyle{agsm}
\bibliography{bibliography.bib}

\end{document}
